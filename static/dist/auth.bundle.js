var e={};(()=>{var t=e;function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}Object.defineProperty(t,"BJ",{value:!0}),t.Ay=t.sy=void 0;var i=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tokenKey="javaToken",this.initializeAuth()},(t=[{key:"initializeAuth",value:function(){var e=this.getToken();if(e)try{var t=this.decodeToken(e);this.updateUIWithTokenInfo(t),this.startTokenExpirationMonitor(t)}catch(e){console.error("Token validation failed:",e),this.logout()}else window.location.href="login.html"}},{key:"getToken",value:function(){return localStorage.getItem(this.tokenKey)}},{key:"decodeToken",value:function(e){var t=e.split(".");return JSON.parse(atob(t[1]))}},{key:"updateUIWithTokenInfo",value:function(e){document.getElementById("loginUser").textContent="User: ".concat(e.preferred_username||"Unknown"),document.getElementById("tenantName").textContent="Tenant: ".concat(e.tenant||"Not set")}},{key:"startTokenExpirationMonitor",value:function(e){var t=this,o=1e3*e.exp-Date.now();if(o<=0)this.handleExpiredToken();else{var n=o-2e4;n>0&&setTimeout((function(){return t.refreshToken()}),n),setTimeout((function(){return t.handleExpiredToken()}),o)}}},{key:"handleExpiredToken",value:function(){alert("Token expired. Please log in again."),localStorage.removeItem(this.tokenKey),window.location.href="login.html"}},{key:"logout",value:function(){localStorage.removeItem(this.tokenKey),window.location.href="https://www.sensorsreport.net/auth/realms/sr/protocol/openid-connect/logout"}},{key:"showTokenInfo",value:function(){var e=this.getToken();if(e)try{var t=this.decodeToken(e);alert("Decoded Token:\n"+JSON.stringify(t,null,2))}catch(e){console.error("Failed to decode token:",e),alert("Failed to decode token.")}}},{key:"refreshToken",value:function(){var e=this,t=this.getToken();t?fetch("https://www.sensorsreport.net/auth/realms/sr/protocol/openid-connect/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:t})}).then((function(e){if(!e.ok)throw new Error("Failed to refresh token");return e.json()})).then((function(t){t.access_token?(localStorage.setItem(e.tokenKey,t.access_token),console.log("Token refreshed successfully.")):console.warn("No access token received during refresh.")})).catch((function(e){console.error("Error refreshing token:",e)})):console.warn("No token available to refresh.")}}])&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o}(),a=t.sy=new i;document.getElementById("showTokenButton").addEventListener("click",(function(){return a.showTokenInfo()})),document.getElementById("logoutButton").addEventListener("click",(function(){return a.logout()}));t.Ay=i})();var t=e.BJ,o=e.sy,n=e.Ay;export{t as __esModule,o as authManager,n as default};